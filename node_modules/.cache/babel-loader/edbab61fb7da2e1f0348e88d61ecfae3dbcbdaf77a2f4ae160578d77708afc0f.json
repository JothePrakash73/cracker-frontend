{"ast":null,"code":"import React,{useState}from'react';import'./AfterPayment.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function SubmitOrder(_ref){let{cartItems}=_ref;const[name,setName]=useState('');const[phone,setPhone]=useState('');const[place,setPlace]=useState('');const[landmark,setLandmark]=useState('');const[billFile,setBillFile]=useState(null);const[screenshotFile,setScreenshotFile]=useState(null);const[billNumber,setBillNumber]=useState('');// store generated bill number\n// ✅ Function to generate Excel-like A, B, ... Z, AA, AB numbering\nconst generateBillNumber=n=>{let result='';while(n>0){n--;// Adjust for 0-based index\nresult=String.fromCharCode(n%26+65)+result;n=Math.floor(n/26);}return result;};const validateFiles=()=>{if(!billFile){alert('Please upload a valid PDF bill.');return false;}if(billFile.type!=='application/pdf'){alert('Invalid file type. Please upload a PDF file for the bill.');return false;}if(!screenshotFile){alert('Please upload your payment screenshot.');return false;}if(!screenshotFile.type.startsWith('image/')){alert('Invalid screenshot format. Please upload a valid image.');return false;}return true;};const handleSubmit=async e=>{e.preventDefault();if(!validateFiles())return;try{// ✅ Fetch last bill index from backend\nconst lastRes=await fetch('http://localhost:5000/api/last-bill-number');const lastData=await lastRes.json();const nextBillIndex=lastData!==null&&lastData!==void 0&&lastData.lastBillIndex?lastData.lastBillIndex+1:1;const newBillNumber=generateBillNumber(nextBillIndex);setBillNumber(newBillNumber);// Prepare form data\nconst formData=new FormData();formData.append('name',name);formData.append('phone',phone);formData.append('place',place);formData.append('landmark',landmark);formData.append('bill',billFile);formData.append('screenshot',screenshotFile);formData.append('billNumber',newBillNumber);// send to backend\nconst res=await fetch('http://localhost:5000/api/order-upload',{method:'POST',body:formData});const data=await res.json();if(data.success){alert(\"\\u2705 Order Submitted!\\nBill Number: \".concat(newBillNumber));window.location.href=data.whatsappURL;}else{alert('Upload failed. Please try again.');}}catch(err){console.error(err);alert('Error submitting order. Please try again later.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"after-payment-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Submit Your Order\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:e=>setName(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:phone,onChange:e=>setPhone(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Place\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:place,onChange:e=>setPlace(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Landmark\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:landmark,onChange:e=>setLandmark(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Upload PDF Bill\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"application/pdf\",onChange:e=>setBillFile(e.target.files[0]),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Upload Payment Screenshot\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>setScreenshotFile(e.target.files[0]),required:true}),billNumber&&/*#__PURE__*/_jsxs(\"p\",{className:\"bill-number-display\",children:[\"Generated Bill Number: \",/*#__PURE__*/_jsx(\"b\",{children:billNumber})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit Order to WhatsApp\"})]})]});}export default SubmitOrder;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","SubmitOrder","_ref","cartItems","name","setName","phone","setPhone","place","setPlace","landmark","setLandmark","billFile","setBillFile","screenshotFile","setScreenshotFile","billNumber","setBillNumber","generateBillNumber","n","result","String","fromCharCode","Math","floor","validateFiles","alert","type","startsWith","handleSubmit","e","preventDefault","lastRes","fetch","lastData","json","nextBillIndex","lastBillIndex","newBillNumber","formData","FormData","append","res","method","body","data","success","concat","window","location","href","whatsappURL","err","console","error","className","children","onSubmit","value","onChange","target","required","accept","files"],"sources":["C:/Users/jothe/Downloads/Cracker/Cracker/frontend/src/pages/AfterPayment.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport './AfterPayment.css';\r\n\r\nfunction SubmitOrder({ cartItems }) {\r\n  const [name, setName] = useState('');\r\n  const [phone, setPhone] = useState('');\r\n  const [place, setPlace] = useState('');\r\n  const [landmark, setLandmark] = useState('');\r\n  const [billFile, setBillFile] = useState(null);\r\n  const [screenshotFile, setScreenshotFile] = useState(null);\r\n  const [billNumber, setBillNumber] = useState(''); // store generated bill number\r\n\r\n  // ✅ Function to generate Excel-like A, B, ... Z, AA, AB numbering\r\n  const generateBillNumber = (n) => {\r\n    let result = '';\r\n    while (n > 0) {\r\n      n--; // Adjust for 0-based index\r\n      result = String.fromCharCode((n % 26) + 65) + result;\r\n      n = Math.floor(n / 26);\r\n    }\r\n    return result;\r\n  };\r\n\r\n  const validateFiles = () => {\r\n    if (!billFile) {\r\n      alert('Please upload a valid PDF bill.');\r\n      return false;\r\n    }\r\n    if (billFile.type !== 'application/pdf') {\r\n      alert('Invalid file type. Please upload a PDF file for the bill.');\r\n      return false;\r\n    }\r\n\r\n    if (!screenshotFile) {\r\n      alert('Please upload your payment screenshot.');\r\n      return false;\r\n    }\r\n    if (!screenshotFile.type.startsWith('image/')) {\r\n      alert('Invalid screenshot format. Please upload a valid image.');\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!validateFiles()) return;\r\n\r\n    try {\r\n      // ✅ Fetch last bill index from backend\r\n      const lastRes = await fetch('http://localhost:5000/api/last-bill-number');\r\n      const lastData = await lastRes.json();\r\n      const nextBillIndex = lastData?.lastBillIndex ? lastData.lastBillIndex + 1 : 1;\r\n      const newBillNumber = generateBillNumber(nextBillIndex);\r\n      setBillNumber(newBillNumber);\r\n\r\n      // Prepare form data\r\n      const formData = new FormData();\r\n      formData.append('name', name);\r\n      formData.append('phone', phone);\r\n      formData.append('place', place);\r\n      formData.append('landmark', landmark);\r\n      formData.append('bill', billFile);\r\n      formData.append('screenshot', screenshotFile);\r\n      formData.append('billNumber', newBillNumber); // send to backend\r\n\r\n      const res = await fetch('http://localhost:5000/api/order-upload', {\r\n        method: 'POST',\r\n        body: formData\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (data.success) {\r\n        alert(`✅ Order Submitted!\\nBill Number: ${newBillNumber}`);\r\n        window.location.href = data.whatsappURL;\r\n      } else {\r\n        alert('Upload failed. Please try again.');\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Error submitting order. Please try again later.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"after-payment-container\">\r\n      <h2>Submit Your Order</h2>\r\n      <form onSubmit={handleSubmit}>\r\n        <label>Name</label>\r\n        <input type=\"text\" value={name} onChange={(e) => setName(e.target.value)} required />\r\n\r\n        <label>Phone Number</label>\r\n        <input type=\"text\" value={phone} onChange={(e) => setPhone(e.target.value)} required />\r\n\r\n        <label>Place</label>\r\n        <input type=\"text\" value={place} onChange={(e) => setPlace(e.target.value)} required />\r\n\r\n        <label>Landmark</label>\r\n        <input type=\"text\" value={landmark} onChange={(e) => setLandmark(e.target.value)} required />\r\n\r\n        <label>Upload PDF Bill</label>\r\n        <input\r\n          type=\"file\"\r\n          accept=\"application/pdf\"\r\n          onChange={(e) => setBillFile(e.target.files[0])}\r\n          required\r\n        />\r\n\r\n        <label>Upload Payment Screenshot</label>\r\n        <input\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={(e) => setScreenshotFile(e.target.files[0])}\r\n          required\r\n        />\r\n\r\n        {billNumber && (\r\n          <p className=\"bill-number-display\">\r\n            Generated Bill Number: <b>{billNumber}</b>\r\n          </p>\r\n        )}\r\n\r\n        <button type=\"submit\">Submit Order to WhatsApp</button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SubmitOrder;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}